<link rel="stylesheet" href="/atomos/lib/atomos.css" />
<div class="btn-toolbar">
	<div class="btn-group mr-1 btn-group-sm" style="flex-shrink:0">
		<button class="btn btn-outline-primary material-icons" disabled="disabled" id="navigateBack" onclick="goBack()">arrow_back</button>
		<button class="btn btn-outline-primary material-icons" disabled="disabled" id="navigateForward" onclick="goForward()">arrow_forward</button>
	</div>
	<div class="btn-group mr-1 btn-group-sm">
		<button class="btn btn-outline-primary material-icons" onclick="reNavigate()">refresh</button>
	</div>
	<div class="input-group" style="
    flex-grow: 2;
"><input class="form-control form-control-sm" type="text" id="path"></div>
</div>

<section>
	<ul class="dropdown-menu border border-left-0 border-top-0 border-bottom-0" style="display:block;" viewMode="list" id="sidebar">
		<div class="dropdown-header">Favorites</div>
		<button class='dropdown-item active' data-location="/atomos/home/"><i class="material-icons mr-1 text-primary">home</i> Home</button>
		<button class="dropdown-item" data-location="/"><i class="material-icons mr-1 text-primary">dns</i> Root</button>
		<div class="dropdown-header">Libraries</div>
		<button class="dropdown-item" data-location="/atomos/home/Documents/"><i class="material-icons mr-1 text-info">insert_drive_file</i> Documents</button>
		<button class="dropdown-item" data-location="/atomos/home/Music/"><i class="material-icons mr-1" style="color: orangered">music_note</i> Music</button>
		<button class="dropdown-item" data-location="/atomos/home/Pictures/"><i class="material-icons mr-1 text-success">image</i> Pictures</button>
		<button class="dropdown-item" data-location="/atomos/home/Videos/"><i class="material-icons text-danger mr-1">movie</i> Videos</button>
	</ul>

	<div class="files dropdown-menu" viewMode="bigtiles">

	</div>
</section>
<div class="ofdBar input-group p-1 bg-light hide" style="flex-shrink:0;border-top:1px solid lightgray;">
	<span class="input-group-btn">
	<button class="btn btn-sm btn-secondary btn-block" onclick="window.close()">Cancel</button>
</span>
	<input type="text" class="form-control form-control-sm" id="ofdFile" readonly>
	<span class="input-group-btn">
		<button class="btn btn-sm btn-primary btn-block" onclick="submitFile()" disabled>Open</button>
	</span>
</div>
<script>
	var fm = {};
	const {
		clipboard,
		remote,
		ipcRenderer
	} = require('electron')
	const {
		Menu
	} = remote;
	var fs = require("fs-extra");
	window.$ = window.jQuery = require('jquery');
	require('atomos-framework');
	window.arguments = ipcRenderer.sendSync("getArguments", remote.getCurrentWindow().id);
	window.Popper = require("popper.js");
	require("bootstrap");

	fm.elements = [];
	fm.folders = [];
	fm.files = [];
	fm.nHistory = [];
	fm.historyNow = -1;
	fm.sorting = "A-Z";
	fm.window = remote.getCurrentWindow();
	if (fm.window.id < 5) {
		fm.desktop = true;
		$("#sidebar").remove();
		$(".btn-toolbar").hide();
		$("body").addClass("desktop");
		$(".files").attr("viewMode", "gigtiles")
		fm.path = "/atomos/home/Desktop/";
		fm.showHidden = true;
		fm.foldersFirst = false;
		fm.arguments = {path: fm.path};
		$("#path").val(fm.path)
		navigate("/atomos/home/Desktop/");
		$.getJSON("/atomos/etc/aos-release.json", function(info) {
			$("body").append("<copyright style='position:fixed;bottom:46px;font-family:monospace;right:0;z-index:-1;color:white;text-align:right; margin:0.5rem'>" + info.name + " " + info.version + "_" + info.build + "<br>Code name: \"" + info.codename + "\"</copyright>")
		})
	} else {
		fm.desktop = false;
		fm.foldersFirst = true;
		fm.showHidden = false;
		fm.arguments = window.arguments;
		fm.path = "/atomos/home/";
		$("#path").val(fm.path)
		fm.arguments.path ? 1 + 1 : fm.arguments.path = fm.path;
		fm.action = fm.arguments["action"];
		navigate(fm.arguments.path, fm.arguments["selectFile"] || "");
	}
	initContextMenus();
	initShortcuts();
	$("body").on("click", "#sidebar [data-location]", function() {
		$("#sidebar>.nav>li").removeClass("active");
		$(this).parent("li").addClass("active");
		navigate($(this).attr("data-location"));
	}).on("dblclick", "[type=folder]", function() {
		if (!fm.desktop) navigate($(this).attr("data-location"));
		else window.new("aos-cabinet", {
			path: $(this).attr("data-location")
		})
	}).on("mouseup", "[type]", function() {
		if ($(this).attr("type") == "file" || $(this).attr("type") == "shortcut") {
			$("#ofdFile").val($(this).attr("realname") || $(this).children(".file-title").text());
			$(".ofdBar button.btn-primary").removeAttr("disabled");
		} else {
			$(".ofdBar button.btn-primary").attr("disabled", "disabled");
			$("#ofdFile").val("");
		}
	}).on("dblclick", "[type=file]", function() {
		if (fm.action) submitFile();
		else
			window.fileOpen(fm.path + $(this).children(".file-title").text());
	}).on("dblclick", "[type=shortcut]", function() {
		if (fm.action) submitFile();
		else
			window.fileOpen(fm.path + $(this).attr("realname"));
	});


	if (fm.action) {
		$("#sidebar").hide();
		fm.window.setMinimumSize(500, 250);
		fm.window.setSize(500, 250);
		fm.window.setMaximizable(false);
		fm.window.setResizable(false);
		$(".ofdBar .btn-primary").text(fm.arguments.okText || "Open");
		$(".ofdBar .btn-secondary").text(fm.arguments.cancelText || "Cancel");
		fm.window.setTitle(fm.arguments.title);
		if (fm.action == "sfd") {
			$(".ofdBar .btn-primary").text(fm.arguments.okText || "Save");
			$("#ofdFile").removeAttr("readonly");
			$("#ofdFile").on("input change", function() {
				if ($(this).val() == "") $(".ofdBar button.btn-primary").attr("disabled", "disabled");
				else $(".ofdBar button.btn-primary").removeAttr("disabled");
			})
		}
		$(".ofdBar").removeClass("hide");
	}

	function reNavigate() {
		navigate(fm.path, "reload");
	}

	function navigate(path, historymode) {
		$(".files").html("");
		$("#ofdFile").val("");
		$(".ofdBar button.btn-primary").prop("disabled", "disabled");
		if (path === undefined) path = "/";
		fm.path = path;
		fm.viewMode = $(".files").attr("viewmode");
		$("[data-location]").removeClass("active");
		$("[data-location='" + path + "']").addClass("active");
		var nohistory = false;
		if (historymode == "back") fm.historyNow--;
		else if (historymode == "forward") fm.historyNow++;
		else if (historymode == "reload") 1 + 1;
		else {
			fm.historyNow++;
			fm.nHistory.splice(fm.historyNow, fm.nHistory.length);
			fm.nHistory.push(fm.path);
			nohistory = true
		}

		checkHistory();

		$("#path").val(path);
		list(path, (data) => {
			if (fm.action) {
				if (fm.viewMode == "list") $('div.files').prepend('<button data-location="' + path.substring(0, path.lastIndexOf("/", path.length - 2)) +
					'/" class="dropdown-item file-item" type="folder"><img src="/atomos/icons/folders-small/Folder.png"><div class="file-title">..</div></button>')
				else $('div.files').prepend('<button data-location="' + path.substring(0, path.lastIndexOf("/", path.length - 2)) +
					'/" class="dropdown-item file-item" type="folder"><img src="/atomos/icons/Extensions Folder.png"><div class="file-title">..</div></button>')
			}

			data.forEach(function(item) {
				if (item.type == "folder") $("div.files").append('<button data-mime="' + item.mimeType + '" data-location="' + path + item.name + '/" class="dropdown-item file-item" type="' + item.type +
					'"><img src="' + item.icon + '"><div class="file-title">' + item.name + '</div></button>')
				else if (item.name.endsWith(".lnk")) {
					var shrt = fs.readFileSync(fm.path + item.name, "utf8");
					shrt = $.parseJSON(shrt);
					$(".files").append("<button type='shortcut' realname='" + item.name + "' class='file-item'><img src='" + shrt.icon + "'><div class='file-title'>" + shrt.title + "</div></button>")
					$(".files .file-item").last().on("dblclick", function(e) {
					    if(!fm.action) e.stopImmediatePropagation();
						window.new(shrt.app, shrt.arguments || {});
					})
				} else $("div.files").append('<button data-mime="' + item.mimeType + '" class="dropdown-item file-item" type="' + item.type + '"><img src="' + item.icon +
					'"></i><div class="file-title">' + item.name + '</div></button>')
			});
			if (nohistory && historymode) $("button:contains('" + historymode + "')").focus();
		});
	}

	function checkHistory() {
		if (fm.nHistory[fm.historyNow + 1] == undefined) $("#navigateForward").attr("disabled", "disabled");
		else
			$("#navigateForward").removeAttr("disabled");
		if (fm.nHistory[fm.historyNow - 1] == undefined) $("#navigateBack").attr("disabled", "disabled");
		else
			$("#navigateBack").removeAttr("disabled");
	}

	function submitFile() {
		var arguments = window.arguments;
		var channel = (fm.action == "ofd" ? "return-file" : "save-file");
		fm.window.getParentWindow().webContents.send(channel, $("#path").val() + "/" + $("#ofdFile").val())
		fm.window.close();
	}

	function goBack() {
		navigate(fm.nHistory[fm.historyNow - 1], "back");
	}

	function goForward() {
		navigate(fm.nHistory[fm.historyNow + 1], "forward");
	}

	function list(path, callback) {
		var result = [];
		fs.readdir(path, function(errno, files) {
			files.forEach(function(file) {
				if (!fm.showHidden && file.startsWith(".")) return;
				var fileRes = {
					"name": file
				}
				var stat = fs.lstatSync(path + "/" + file);
				if (stat.isFile()) {
					fileRes.type = "file";
					fileRes.mimeType = window.getMimeType(file.substring(file.lastIndexOf(".") + 1));
				} else if (stat.isDirectory()) fileRes.type = "folder";
				else if (stat.isSymbolicLink()) {
					fileRes.link = true;
					try {
					var link = fs.readlinkSync(path + file);
					var statLink = fs.statSync((link.startsWith("/") ? link : path + link));
					if (statLink.isFile()) {
						fileRes.type = "file";
						fileRes.mimeType = window.getMimeType(link.substring(link.lastIndexOf(".") + 1));
					} else if (statLink.isDirectory()) fileRes.type = "folder";} catch(e){}
				} else return;
				fileRes.atime = stat.atime;
				fileRes.mtime = stat.mtime;
				fileRes.ctime = stat.ctime;
				try {
					fs.accessSync(path, fs.constants.R_OK);
					fileRes.readable = true
				} catch (e) {
					fileRes.readable = false
				}
				try {
					fs.accessSync(path, fs.constants.W_OK);
					fileRes.writable = true
				} catch (e) {
					fileRes.writable = false
				}
				try {
					fs.accessSync(path, fs.constants.X_OK);
					fileRes.executable = true
				} catch (e) {
					fileRes.executable = false
				}
				if (fileRes.type == "folder") {

					if (fs.existsSync(path + "/" + file + "/.folderinfo")) {
						var data = $.parseJSON(fs.readFileSync(path + "/" + file + "/.folderinfo", "utf8"));
						if (fm.viewMode == "list") fileRes.icon = data.smallIcon;
						else fileRes.icon = data.icon;
					} else if (fm.viewMode == "list")
						if (fileRes.link) fileRes.icon = "/atomos/icons/folders-small/Symlink Folder.png";
						else fileRes.icon = "/atomos/icons/folders-small/Extensions Folder.png";
					else if (fileRes.link) fileRes.icon = "/atomos/icons/Symlink Folder.png";
					else fileRes.icon = "/atomos/icons/Extensions Folder.png";

				} else if (fileRes.type == "file") {
					var mime = "/atomos/icons/file-types/" + file.substring(file.lastIndexOf(".") + 1).toUpperCase() + ".png";
					if (fs.existsSync(mime)) fileRes.icon = mime;
					else if (fileRes.link) fileRes.icon = "/atomos/icons/file-types/Symlink.png";
					else fileRes.icon = "/atomos/icons/file-types/Unknown.png";
					if (fm.viewMode == "list") fileRes.icon = fileRes.icon.replace(/file-types/g, "file-types-small");
				}
				result.push(fileRes);
			});

			if (fm.sorting == "A-Z") {
				result.sort(function(a, b) {
					var nameA = a.name.toLowerCase(),
						nameB = b.name.toLowerCase();
					if (nameA < nameB) return -1;
					if (nameA > nameB) return 1;
					return 0;
				});
			}
			if (fm.sorting == "Z-A") {
				result.sort(function(a, b) {
					var nameA = a.name.toLowerCase(),
						nameB = b.name.toLowerCase();
					if (nameA < nameB) return 1;
					if (nameA > nameB) return -1;
					return 0;
				});
			}
			if (fm.foldersFirst) {
				var newResult = [];
				result.forEach(function(item) {
					if (item.type == "folder") newResult.push(item);
				})
				result.forEach(function(item) {
					if (item.type == "file") newResult.push(item);
				})
				callback(newResult)
			} else callback(result)

		})
	}

	function initShortcuts() {
		$(window).keydown(function(event) {
			if (event.ctrlKey && event.key == "c") {
				if ($(".file-item:focus").length !== 0) doAction("copy", {
					file: fm.path + $(".file-item:focus .file-title").text()
				});
			}
			if (event.ctrlKey && event.key == "v") doAction("paste");
			if (event.ctrlKey && event.key == "x") {
				if ($(".file-item:focus").length !== 0) doAction("cut", {
					file: fm.path + $(".file-item:focus .file-title").text()
				});
			}
			if (event.key == "Delete") {
				if ($(".file-item:focus").length !== 0) doAction("delete", {
					file: fm.path + $(".file-item:focus .file-title").text()
				});
			}
			if (event.key == "F5") reNavigate();
			if (event.altKey && event.key == "Enter") doAction("properties", {
				file: fm.path + $(".file-item:focus .file-title").text()
			});
		});
	}

	function doAction(action, options) {
		switch (action) {
			case "vmlist":
				$(".files").attr("viewMode", "list");
				break;
			case "vmsmall":
				$(".files").attr("viewMode", "smalltiles");
				break;
			case "vmmid":
				$(".files").attr("viewMode", "midtiles");
				break;
			case "vmlarge":
				$(".files").attr("viewMode", "bigtiles");
				break;
			case "vmgig":
				$(".files").attr("viewMode", "gigtiles");
				break;
			case "sortaz":
				fm.sorting = "A-Z";
				break;
			case "sortza":
				fm.sorting = "Z-A";
				break;
			case "toggleff":
				fm.foldersFirst = !fm.foldersFirst;
				break;
			case "togglesh":
				fm.showHidden = !fm.showHidden;
				break;
			case "paste":
				window.fileClipboard.flush(fm.path)
				break;
			case "copy":
				window.fileClipboard.copyMode = "copy";
				window.fileClipboard.clear();
				window.fileClipboard.add(options.file);
				break;
			case "cut":
				window.fileClipboard.copyMode = "cut";
				window.fileClipboard.clear();
				window.fileClipboard.add(options.file);
				break;
			case "delete":
				fs.remove(options.file, function(err) {
					if (!err) reNavigate();
				})
				break;
			case "properties":
				window.new("properties", {
					path: (options ? options.file : fm.path)
				})
				break;
		}
		reNavigate();
	}

	function initContextMenus() {
		$("body").on("contextmenu", "div.files", function(event) {
			const fmMenu = [{
				label: "View",
				type: "submenu",
				submenu: [{
					label: "List",
					type: "radio",
					visible: !fm.desktop,
					checked: fm.viewMode == "list",
					click() {
						doAction("vmlist")
					}
				}, {
					label: "Small icons",
					type: "radio",
					visible: !fm.desktop,
					checked: fm.viewMode == "smalltiles",
					click() {
						doAction("vmsmall")
					}
				}, {
					label: (fm.desktop ? "Small icons" : "Medium icons"),
					type: "radio",
					checked: fm.viewMode == "midtiles",
					click() {
						doAction("vmmid")
					}
				}, {
					label: (fm.desktop ? "Medium icons" : "Large icons"),
					type: "radio",
					checked: fm.viewMode == "bigtiles",
					click() {
						doAction("vmlarge")
					}
				}, {
					label: "Large icons",
					type: "radio",
					visible: fm.desktop,
					checked: fm.viewMode == "gigtiles",
					click() {
						doAction("vmgig")
					}
				}]
			}, {
				label: "Sort by",
				type: "submenu",
				submenu: [{
					label: "A to Z",
					type: "radio",
					checked: fm.sorting == "A-Z",
					click() {
						doAction("sortaz")
					}
				}, {
					label: "Z to A",
					type: "radio",
					checked: fm.sorting == "Z-A",
					click() {
						doAction("sortza")
					}
				}, {
					type: "separator"
				}, {
					label: "Folders first",
					type: "checkbox",
					checked: fm.foldersFirst,
					click() {
						doAction("toggleff")
					}
				}, {
					label: "Hidden files",
					type: "checkbox",
					checked: fm.showHidden,
					click() {
						doAction("togglesh")
					}
				}]
			}, {
				type: "separator"
			}, {
				label: "Refresh",
				accelerator: "F5",
				click() {
					reNavigate()
				}
			}, {
				label: "Paste",
				accelerator: "CmdOrCtrl+V",
				click() {
					doAction("paste")
				},
				enabled: window.fileClipboard.isFilled
			}, {
				type: "separator"
			}, {
				label: "Create",
				submenu: [{
					label: "File",
					click() {
						window.new("aos-cabinet/createFile", {
							path: fm.path
						}, {
							modal: true,
							parent: fm.window
						});
						ipcRenderer.on('create-file', reNavigate)
					}
				}, {
					label: "Folder",
					click() {
						window.new("aos-cabinet/createFolder", {
							path: fm.path
						}, {
							modal: true,
							parent: fm.window
						});
						ipcRenderer.on('create-folder', reNavigate)
					}
				}]
			}, {
				label: "Properties",
				click() {
					doAction("properties")
				}
			}, {
				type: (!fm.desktop ? 'normal' : 'separator'),
				visible: fm.desktop
			}, {
				label: "Desktop Preferences",
				disabled: true,
				visible: fm.desktop,
				click() {
					window.new("control")
				}
			}]
			fm.filesMenu = Menu.buildFromTemplate(fmMenu);
			fm.filesMenu.popup(fm.window, {async: true});
		});

		$("body").on("contextmenu", ".file-item[type]", function(e) {
			e.stopPropagation();
			var mime = $(this).attr("data-mime") || "text/plain";
			var file = fm.path + ($(this).attr("realname") ? $(this).attr("realname") : $(this).find(".file-title").text())
			console.log(file);
			var $this = $(this);
			fs.readFile("/atomos/etc/associations.json", "utf8", function(err, data) {
				if (!err) var assocs = $.parseJSON(data);
				console.log(data);
				var appName = assocs.find(o => o.mime == mime);
				if (appName) appName = appName["app"];
				const menu = [{
					label: ($this.attr("realname") === undefined ? "Open" + (($this.attr("type") == "folder") ? "" : (!err ? " " + appName : " in default application")) : "Execute"),
					visible: (appName !== undefined) || ($this.attr("type") == "folder"),
					click() {
						$this.trigger("dblclick");
					}
				}, {
					label: "Open using...",
					visible: !($this.attr("type") == "folder"),
					click() {
						window.new("aos-appchooserdialog", {
							path: file,
							mimeType: mime
						})
					}
				}, {
					type: "separator"
				}, {
					label: "Cut",
					accelerator: "CmdOrCtrl+X",
					click() {
						doAction("cut", {
							file: file
						})
					}
				}, {
					label: "Copy",
					accelerator: "CmdOrCtrl+C",
					click() {
						doAction("copy", {
							file: file
						})
					}
				}, {
					type: "separator"
				}, {
					label: "Delete",
					accelerator: "Delete",
					click() {
						doAction("delete", {
							file: file
						})
					}
				}, {
					label: "Properties",
					accelerator: "Alt+Enter",
					click() {
						doAction("properties", {
							file: file
						})
					}
				}]
				Menu.buildFromTemplate(menu).popup(fm.window, {async: true});
			})
		})
	}
</script>
<style>
	#sidebar {
		min-width: 150px;
		position: static;
		padding: 0;
		border: 0;
		margin: 0;
		border-radius: 0;
	}

	div.files {
		flex-grow: 2;
		overflow: auto;
		height: auto;
		border: 0;
		margin: 0;
		display: inline-block;
		position: static;
		background: none
	}

	.files .file-item {
		display: inline-block;
		background: none;
		border: none;
		color: black;
		vertical-align: top;
		padding: 0.25rem .5rem .4rem;
		border-radius: 3px;
		flex-shrink: 0;
	}

	.files .file-title {

		overflow: hidden;
		text-overflow: ellipsis;
		white-space: nowrap;
		margin-left: 0.25rem;
		vertical-align: text-top
	}

	.files[viewMode*=tiles] .file-item {
		margin: 0.3em;
		width: 85px;
		text-align: center;
		word-break: break-word;
	}

	.files[viewMode=list],
	.files[viewMode=gigtiles] {
		display: flex;
		flex-direction: column;
		align-content: flex-start;
	}

	.files[viewMode=gigtiles] {
		flex-wrap: wrap;
	}

	.files {
		padding: 0.25rem
	}

	[viewMode=list] button.active .material-icons,
	[viewMode=list] button:active .material-icons,
	[viewMode=list] button:focus .material-icons {
		color: white !important;
	}

	[viewMode=list].files button.active,
	[viewMode=list].files button:active,
	[viewMode=list].files button:focus {
		color: #fff;
		text-decoration: none;
		background-color: #007bff;
	}

	body.desktop .file-item {
		color: white !important;
		text-shadow: 0 0px 4px rgb(0, 0, 0), 0 0px 7px rgb(0, 0, 0) !important;
		width: 110px !important
	}
	body.desktop .file-item:hover {
        box-shadow: inset 0 0 0 10000px rgba(255, 255, 255, 0.3), 0 0 0 1px rgba(255,255,255,0.5);
	}

	body.desktop .file-title {
		word-break: break-word;
		line-height:1.5 !important;
		max-height:3rem !important;
	}

	body.desktop .file-item:active,
	body.desktop .file-item:focus,
	body.desktop .file-item:focus:active {
        box-shadow: inset 0 0 0 10000px rgba(255, 255, 255, 0.5), 0 0 0 1px rgba(255,255,255,0.5);
	}

	[viewMode=list] .file-item {
		width: 100%;
		text-align: left;
		padding: 0.1rem 0.25rem;
		margin-bottom: 5px;
		line-height: 20px;
	}

	[viewMode=list] .file-item img {
		width: 16px;
		vertical-align: inherit;
		margin: 2px 4px;
	}

	[viewMode=list] .file-title {
		display: inline-block;
	}

	[viewMode=smalltiles] .file-item .material-icons {
		font-size: 24px;
	}

	[viewMode=midtiles] .file-item .material-icons {
		font-size: 32px;
	}

	[viewMode=bigtiles] .file-item .material-icons {
		font-size: 48px;
	}

	[viewMode=gigtiles] .file-item .material-icons {
		font-size: 64px;
	}

	[viewMode=smalltiles] .file-item img {
		width: 24px;
	}

	[viewMode=midtiles] .file-item img {
		width: 32px;
	}

	[viewMode=bigtiles] .file-item img {
		width: 48px;
	}

	[viewMode=gigtiles] .file-item img {
		width: 64px;
	}

	[viewMode*=tiles] .file-item .file-title {

		max-height: 2rem;
		vertical-align: text-top;
		word-break: break-all;
		white-space: pre-wrap;
		line-height: 1;
	}

	.file-item:hover {
		box-shadow: inset 0 0 0 10000px rgba(0, 129, 194, 0.3);
	}

	.file-item:active,
	.file-item:focus,
	.file-item:focus:active {
		box-shadow: inset 0 0 0 10000px rgba(0, 129, 194, 0.5);
	}

	section {
		flex-grow: 2;
		display: flex;
	}

	#navigateBack:not(:disabled)::after {
		content: " Back";
		font-family: "Source Sans Pro", sans-serif;
		font-size: 12px;
		display: inline-block;
		padding-top: 2px;
		vertical-align: middle;
		padding-left: 5px;
	}

	.files:empty::before {
		content: "Nothing here";
		display: block;
		text-align: center;
		width: 100%;
		padding: 0.5rem;
		color: grey;
	}

	body {
		height: 100%;
		overflow: hidden;
		display: flex;
		flex-direction: column;
	}

	body.desktop {
		background: url(/atomos/resources/wallpaper.jpg);
		background-repeat: no-repeat;
		background-size: cover;
		background-position: center;
	}
</style>
